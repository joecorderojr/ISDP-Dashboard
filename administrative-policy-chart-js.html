<script>

const ISOCS = document.getElementById('ISOCS').getContext('2d');
const ISOCSMain = document.getElementById('ISOCSMain').getContext('2d');

const ISOCSdata = {
    labels: ['Complied', 'In Progress'], // Categories
    datasets: [{
        label: 'ISO27001',
        data: <?!=JSON.stringify(iso_27001_compliance_data)?> ,
        backgroundColor: [
          <?!= JSON.stringify(defaultBGColors.green)?>,
          <?!= JSON.stringify(defaultBGColors.yellow)?>
        ],
        borderColor: [
          <?!= JSON.stringify(defaultBorderColors.green)?>,
          <?!= JSON.stringify(defaultBorderColors.yellow)?>
        ],
        borderWidth: 1
    }]
};

const ISOCSconfig = {
    type: 'pie', // Specify the chart type
    data: ISOCSdata,
    options: {
        responsive: true,
        plugins: {
            legend: {
                display: true,
                position: 'top',
                labels: {
                    color: 'white'
                }
            },
            title: {
                display: true,
                text: 'ISO27001',
                color: 'white'
            },
            tooltip: {
                enabled: true,
                callbacks: {
                    // This function generates the text shown in the tooltip
                    label: function(context) {
                        const label = context.label || '';
                        const value = context.raw || 0;
                        return `${value}`; // Displays "Compliant: 75%"
                    }
                }
            }
        }
    },
};

const ISOCSMainconfig = {
    type: 'pie', // Specify the chart type
    data: ISOCSdata,
    options: {
        responsive: true,
        plugins: {
            datalabels: { display: false },
            legend: { display: false },
            title: {
                display: true,
                text: 'ISO27001',
                color: 'white',
            },
            tooltip: {
                enabled: true,
                callbacks: {
                    // This function generates the text shown in the tooltip
                    label: function(context) {
                        const label = context.label || '';
                        const value = context.raw || 0;
                        return `${value}`; // Displays "Compliant: 75%"
                    }
                }
            }
        }
    },
};

const ISOCSPieChart = new Chart(ISOCS, ISOCSconfig);
const ISOCSMainPieChart = new Chart(ISOCSMain, ISOCSMainconfig);

const ISOBUS = document.getElementById('ISOBUS').getContext('2d');
const ISOBUSMain = document.getElementById('ISOBUSMain').getContext('2d');

const ISO270001Data = {
  labels: <?!= JSON.stringify(iso_27001_data.labels) ?>,
  datasets: [
    {
      label: "Revised",
      data: <?!= JSON.stringify(iso_27001_data.revised) ?>,
      backgroundColor: <?!= JSON.stringify(defaultBGColors.green)?>,
      borderColor: <?!= JSON.stringify(defaultBorderColors.green)?>,
      borderWidth: 1
    },
    {
      label: "For Review",
      data: <?!= JSON.stringify(iso_27001_data.forReview) ?>,
      backgroundColor: <?!= JSON.stringify(defaultBGColors.yellow)?>,
      borderColor: <?!= JSON.stringify(defaultBorderColors.yellow)?>,
      borderWidth: 1
    },
    {
      label: "Overdue",
      data: <?!= JSON.stringify(iso_27001_data.overdue) ?>,
      backgroundColor: <?!= JSON.stringify(defaultBGColors.red)?>,
      borderColor: <?!= JSON.stringify(defaultBorderColors.red)?>,
      borderWidth: 1
    },
  ]
};

const ISOBUSconfig = {
    type: 'bar',
    data: ISO270001Data,
    options: {
        responsive: true,
        plugins: {
            legend: {
                display: true, // Show legend
                position: 'top', // Legend position
                labels: {
                    color: 'white', // Legend text color
                }
            },
            title: {
                display: true,
                text: 'ISO27001 Document Status',
                color: 'white'
            },
            tooltip: {
                enabled: true, // Enable tooltips
            }
        },
        scales: {
            x: { 
                ticks: {
                    color: 'white', // Set Y-axis tick label color to white
                    display: true
                },
                title: {
                    display: false,
                    text: 'Colors'
                },
                stacked: false // Bars are side-by-side (default)
            },
            y: { 
                ticks: {
                    color: 'white' // Set Y-axis tick label color to white
                },
                beginAtZero: true,
                title: {
                    display: true,
                }
            }
        }
    }
};

const ISOBUSMainconfig = {
    type: 'bar',
    data: ISO270001Data,
    options: {
        maintainAspectRatio: false,
        layout: {
            padding: 0 // Removes all internal padding to let the chart fill the div height
        },
        plugins: {
            datalabels: { display: false },
            legend: { display: false },
            title: {
                display: true,
                text: 'ISO27001 Document Status',
                color: 'white'
            },
            tooltip: {
                enabled: true, // Enable tooltips
            }
        },
        scales: {
            x: { 
                ticks: {
                    color: 'white', // Set Y-axis tick label color to white
                    display: true
                },
                title: {
                    display: false,
                    text: 'Colors'
                },
                stacked: false // Bars are side-by-side (default)
            },
            y: { 
                ticks: {
                    color: 'white' // Set Y-axis tick label color to white
                },
                beginAtZero: true,
                title: {
                    display: true,
                }
            }
        }
    }
};

const ISOBUSChart = new Chart(ISOBUS, ISOBUSconfig);
const ISOBUSMainChart = new Chart(ISOBUSMain, ISOBUSMainconfig);


const DocReviewMain = document.getElementById("DocReviewMain").getContext("2d");
const DocReviewMainData =  <?!=JSON.stringify(pivotCountsToChartDocStatusDataPercentage(null,null));?>;

const DocReviewMainConfig = {
  type: "bar",
  data: DocReviewMainData,
  options: {
    responsive: true,
    plugins: {
      datalabels: {
        anchor: "middle",
        color: function (context) {
          return "white";
        },
        font: { size: 11 },
        formatter: (value) => {
          if (value === 0) {
            return null; // or return "";
          }
          return value + "%";
        },
        offset: 2,
        padding: 0,
      },
      legend: {
        display: true, // Show legend
        position: 'top', // Legend position
        labels: {
            color: 'white', // Legend text color
        }
      },
      title: {
        display: true,
        text: "Documents Review per Unit",
        color: "white"
      },
      tooltip: customTooltipSingleBar,
    },
    scales: {
      x: { 
        stacked: true,
        ticks: {
                  color: 'white', // Set Y-axis tick label color to white
                  display: true
              },
        },
      y: {
        stacked: true,
        max: 100,
        ticks: {
          callback: (value) => value + "%",
          color: 'white'
        }
      }
    },
  },
};

  
const DocReviewMainbar = new Chart(DocReviewMain, DocReviewMainConfig);


const SOC2TYPE2 = document.getElementById('SOC2TYPE2').getContext('2d');
const SOC2TYPE2Main = document.getElementById('SOC2TYPE2Main').getContext('2d');

const SOC2TYPE2data = {
    labels: <?!= JSON.stringify(soc2Type2_data.labels) ?>,
    datasets: [{
        label: 'SOC2 TYPE2',
        data: <?!= JSON.stringify(soc2Type2_data.values) ?>,
        backgroundColor: [
          <?!= JSON.stringify(defaultBGColors.green)?>, 
          <?!= JSON.stringify(defaultBGColors.yellow)?>,
          <?!= JSON.stringify(defaultBGColors.red)?>,
        ],
        borderColor: [
          <?!= JSON.stringify(defaultBorderColors.green)?>, 
          <?!= JSON.stringify(defaultBorderColors.yellow)?>,
          <?!= JSON.stringify(defaultBorderColors.red)?>,
        ],
        borderWidth: 1
    }]
};

const SOC2TYPE2config = {
    type: 'polarArea',
    data: SOC2TYPE2data,
    options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
            legend: {
                display: true,
                position: 'top',
                labels: {
                    color: 'white',
                    padding: 20,
                    font: {
                        size: 12
                    }
                }
            },
            title: {
                display: true,
                text: 'SOC2 TYPE2',
                color: 'white',
            },
            tooltip: {
                enabled: true,
                callbacks: {
                    label: function(context) {
                        return ` ${context.label}: ${context.raw}%`;
                    }
                }
            }
        },
        scales: {
            r: {
                // Radial scale configuration
                min: 0,
                max: 100,
                beginAtZero: true,
                grid: {
                    color: 'rgba(255, 255, 255, 0.2)' // Increased visibility for polar effect
                },
                angleLines: {
                    display: true,
                    color: 'rgba(255, 255, 255, 0.2)' // Lines that separate the sectors
                },
                ticks: {
                    display: false, // Hides numbers on the concentric circles
                    stepSize: 20
                },
                pointLabels: {
                    display: true, // Show labels around the perimeter
                    color: 'white',
                    font: {
                        size: 11
                    }
                }
            }
        }
    }
};

const SOC2TYPE2Mainconfig = {
    type: 'polarArea',
    data: SOC2TYPE2data,
    options: {
        responsive: true,
        plugins: {
            datalabels: { display: false },
            legend: { display: false },
            title: {
                display: true,
                text: 'SOC2 TYPE2',
                color: 'white',
            },
            tooltip: {
                enabled: true,
                callbacks: {
                    label: function(context) {
                        return ` ${context.label}: ${context.raw}%`;
                    }
                }
            }
        },
        scales: {
            r: {
                // Radial scale configuration
                min: 0,
                max: 100,
                beginAtZero: true,
                grid: {
                    color: 'rgba(255, 255, 255, 0.2)' // Increased visibility for polar effect
                },
                angleLines: {
                    display: true,
                    color: 'rgba(255, 255, 255, 0.2)' // Lines that separate the sectors
                },
                ticks: {
                    display: false, // Hides numbers on the concentric circles
                    stepSize: 20
                },
                pointLabels: {
                    display: false, // Show labels around the perimeter
                }
            }
        }
    }
};

const SOC2TYPE2PieChart = new Chart(SOC2TYPE2, SOC2TYPE2config);
const SOC2TYPE2MainPieChart = new Chart(SOC2TYPE2Main, SOC2TYPE2Mainconfig);


const DPA = document.getElementById("DPA").getContext("2d");
const DPAMain = document.getElementById("DPAMain").getContext("2d");

const DPAMainData = {
  labels: <?!= JSON.stringify(npc_checklist_data.labels) ?>,
  datasets: [
    {
      data: <?!= JSON.stringify(npc_checklist_data.values) ?>,
      backgroundColor: [<?!= JSON.stringify(defaultBGColors.green)?>, <?!= JSON.stringify(defaultBGColors.red)?>],
      hoverOffset: 4,
      borderColor: [<?!= JSON.stringify(defaultBorderColors.green)?>, <?!= JSON.stringify(defaultBorderColors.red)?>],
      borderWidth: 1
    },
    
  ],
};
const DPAMainconfig = {
    type: 'pie',
    data: DPAMainData,
    options: {
        responsive: true,
        plugins: {
            legend: {
                display: true,
                position: 'top',
                labels: {
                    color: 'white',
                }
            },
            title: {
                display: true,
                text: 'Data Privacy Act (DPA) of 2012',
                color: 'white'
            },
            tooltip: {
                enabled: true
            }
        }
    },
};

const DPAconfig = {
    type: 'pie',
    data: DPAMainData,
    options: {
        responsive: true,
        plugins: {
            datalabels: { display: false },
            legend: { display: false },
            title: {
                display: true,
                text: 'Data Privacy Act (DPA) of 2012',
                color: 'white'
            },
            tooltip: {
                enabled: true
            }
        }
    },
};
 
const DPACnfigChart = new Chart(DPA, DPAconfig);
 
const DPAchartMain = new Chart(DPAMain, DPAMainconfig);

</script>